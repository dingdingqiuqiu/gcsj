import{_ as i,c as a,o as l,ae as n}from"./chunks/framework.ChhGBEr5.js";const c=JSON.parse('{"title":"MySQL开发技巧-视图","description":"","frontmatter":{"title":"MySQL开发技巧-视图","mathjax":true,"date":"2024-10-29T17:03:44.000Z","tags":null,"categories":"数据库"},"headers":[],"relativePath":"笔记/Old/MySQL开发技巧-视图.md","filePath":"笔记/Old/MySQL开发技巧-视图.md","lastUpdated":1743185048000}'),t={name:"笔记/Old/MySQL开发技巧-视图.md"};function p(h,s,e,k,E,d){return l(),a("div",null,s[0]||(s[0]=[n(`<p>本文基于头歌平台-MySQL开发技巧-视图学习相关知识，并做记录。</p><h3 id="第1关-视图" tabindex="-1">第1关：视图 <a class="header-anchor" href="#第1关-视图" aria-label="Permalink to &quot;第1关：视图&quot;">​</a></h3><h4 id="创建视图" tabindex="-1">创建视图 <a class="header-anchor" href="#创建视图" aria-label="Permalink to &quot;创建视图&quot;">​</a></h4><div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> select_statement [WITH [CASCADED | LOCAL] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHECK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OPTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>参数说明：</p><ul><li><p>OR REPLACE：表示替换已有视图；</p></li><li><p>ALGORITHM：表示视图选择算法，默认算法是UNDEFINED(未定义的)： MySQL 自动选择要使用的算法 ；merge合并；temptable临时表；</p></li><li><p>column_list：可选参数，指定视图中各个属性的名词，默认情况下与select语句中查询的属性相同；</p></li><li><p>select_statement：表示select语句；</p></li><li><p>[WITH [CASCADED | LOCAL] CHECK OPTION]：表示视图在更新时保证在视图的权限范围之内；cascade是默认值，表示更新视图的时候，要满足视图和表的相关条件；local表示更新视图的时候，要满足该视图定义的一个条件即可。</p></li></ul><h4 id="创建视图示例" tabindex="-1">创建视图示例 <a class="header-anchor" href="#创建视图示例" aria-label="Permalink to &quot;创建视图示例&quot;">​</a></h4><p>示例一：</p><p><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9mYmQ0NGEwNjM2YTQyNDJlL0VZMkVKQWM1RjhSUHFHblJ4dmlydjk4QmFDTkNfUHhhWXRrT1hIazB0UktWQ0E_ZT1wVVZkM3k.jpg" alt="image-20241029172650778" loading="lazy"></p><p>示例二：</p><p><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9mYmQ0NGEwNjM2YTQyNDJlL0VlWmpvc0hkMk9KT2g1OTVjVmRZendnQllrRHpnNHFqSnZTbi1tTEF6WFJrX1E_ZT1OUXUyMU4.jpg" alt="image-20241029173015508" loading="lazy"></p><p>以上两个示例可以看出，虽然两个视图的字段名不同，但是，数据是相同的，因为两个视图引用的是同一个表中的数据，并且，as后的创建视图的语句也相同。</p><p>在实际开发中，用户可以根据自己的需求，通过视图的方式，获取基本表中自己需要的数据，这样既能满足用户的需求，也不会破坏基本表原来的结构，从而保证了基本表中数据的安全性。</p><h4 id="操作视图" tabindex="-1">操作视图 <a class="header-anchor" href="#操作视图" aria-label="Permalink to &quot;操作视图&quot;">​</a></h4><p>视图是逻辑表，也就是说视图不是真实的表，但操作视图和操作普通表的语法是一样的。</p><p>用户可以在视图中无条件地使用<code>select</code>语句查询数据。但使用<code>inser</code>、<code>update</code>和<code>delete</code>操作需要在创建视图时满足以下条件（满足以下条件的视图称为<strong>可更新视图</strong>）：</p><ul><li><p>from子句中只能引用有1个表（真实表或可更新视图）；</p></li><li><p>不能包含 with、distinct、group by、having、limit等子句；</p></li><li><p>不能使用复合查询，即不能使用union、intersect、except等集合操作；</p></li><li><p>select子句的字段列表不能包含聚合、窗口函数、集合返回函数。</p></li></ul><p>我们仍使用之前示例中的数据来操作视图：</p><p><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9mYmQ0NGEwNjM2YTQyNDJlL0VTWWEzSVMtWUN4UGlmYUoxTGJvZURjQjA3ZjBneEpsVmhucFBreWxmVjlYRHc_ZT1BTEFsY0g.jpg" alt="image-20241029174447708" loading="lazy"></p><blockquote><p>注意这里因为使用了limit子句，因此创建的视图是不可更新的，我们修改会失败。</p></blockquote><h4 id="删除视图" tabindex="-1">删除视图 <a class="header-anchor" href="#删除视图" aria-label="Permalink to &quot;删除视图&quot;">​</a></h4><p>若视图不再被需要，我们可以将其删除，且视图的删除并不影响源表中的数据。</p><p>删除视图的 SQL 如下：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> view_name;</span></span></code></pre></div><p><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9mYmQ0NGEwNjM2YTQyNDJlL0VVZlk1bkpxc05aS3RFby03VkQzZ0hBQlZ1aGtKbnBsTkwwSEZvT0J4YmtWbVE_ZT1MenBaS0Y.jpg" alt="image-20241029174644473" loading="lazy"></p><h4 id="应用" tabindex="-1">应用 <a class="header-anchor" href="#应用" aria-label="Permalink to &quot;应用&quot;">​</a></h4><p><img src="https://dlink.host/1drv/aHR0cHM6Ly8xZHJ2Lm1zL2kvYy9mYmQ0NGEwNjM2YTQyNDJlL0VYWWZOclppS1Q1SHJ2WmIyOVFXTWlvQkhUTkstcGhQSkdXMWU2dFhWT29weEE_ZT1oTVExNGQ.jpg" alt="image-20241029174720465" loading="lazy"></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> School;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.创建单表视图</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> stu_view</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    math, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chinese, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (math </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chinese) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;math+chinese&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    student;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.创建多表视图</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> stu_classes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    student</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stu_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    student</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    stu_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">classes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    student </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    stu_info </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    student</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stu_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stu_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stu_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><blockquote><p>注意创建单表视图时，定义一个<code>math+chese</code>之和字段的语句为<code>(math+chese) as &quot;math+chinese&quot; </code>注意这里的别名<strong>需要用引号括起来</strong>，不然包报错的。</p><p>行之和直接加，列之和<code>SUM</code>函数。</p></blockquote><blockquote><p>创建多表视图时，连接操作是<code>JOIN 表名 ON 连接条件</code></p></blockquote>`,30)]))}const o=i(t,[["render",p]]);export{c as __pageData,o as default};
